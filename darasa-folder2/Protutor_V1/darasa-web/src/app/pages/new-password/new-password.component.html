<!-- Main content -->
<section class="main-section">
  <div class="container d-flex flex-column">
    <div class="row align-items-center justify-content-center min-vh-100">
      <div class="col-md-8 py-6 py-md-0">
        <div class="row justify-content-center">
          <div class="card shadow zindex-100 mb-0">
            <div class="card-body px-md-5 py-5">
              <div class="mb-3 text-center">
                <h3 class="text-primary">Darasa LMS</h3>
                <p class="text-muted mb-0">Please enter your new password</p>
                <div class="underline bg-primary mx-auto mt-3"></div>
              </div>
              <div class="mt-3" *ngFor="let alert of alerts">
                <ngb-alert [type]="alert.type" *ngIf="!alert.closed" (close)="closeAlert(alert)">
                  {{ alert.message }}
                </ngb-alert>
              </div>
              <form [formGroup]="newPasswordForm" novalidate (ngSubmit)="onSubmit()" autocomplete="off">
                <div class="row justify-content-center">
                  <div class="col-lg-6 mb-3">
                    <div class="form-group">
                      <div class="position-relative w-100">
                        <div class="position-relative">
                          <i-feather name="lock" class="left-icon position-absolute"
                            [ngClass]="{ 'text-danger': (submitted || f.password.touched) && f.password.invalid}">
                          </i-feather>
                          <input [type]="passwordVisible ? 'text' : 'password'" formControlName="password"
                            class="form-control bg-white px-5 " placeholder="Password"
                            [ngClass]="{ 'is-invalid': (submitted || f.password.touched) && f.password.invalid}" />
                          <i-feather [name]="passwordVisible ? 'eye' : 'eye-off'" class="right-icon position-absolute"
                            (click)="togglePassword()"
                            [ngClass]="{ 'text-danger': (submitted || f.password.touched) && f.password.invalid}">
                          </i-feather>
                        </div>
                        <small *ngIf="(submitted || f.password.touched) && f.password.hasError('required')"
                          class="form-text text-danger">
                          Password is required
                        </small>
                        <small *ngIf="(submitted || f.password.dirty) && f.password.hasError('minlength')"
                          class="form-text text-danger">
                          Must be at least 8 characters!
                        </small>
                        <small *ngIf="(submitted || f.password.dirty) && f.password.hasError('hasNumber')"
                          class="form-text text-danger">
                          Must contain at least 1 number!
                        </small>
                        <small *ngIf="(submitted || f.password.dirty) && f.password.hasError('hasCapitalCase')"
                          class="form-text text-danger">
                          Must contain at least 1 in Capital Case!
                        </small>
                        <small *ngIf="(submitted || f.password.dirty) && f.password.hasError('hasSmallCase')"
                          class="form-text text-danger">
                          Must contain at least 1 Letter in Small Case!
                        </small>
                        <small *ngIf="(submitted || f.password.dirty) && f.password.hasError('hasSpecialCharacters')"
                          class="form-text text-danger">
                          Must contain at least 1 Special Character!
                        </small>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <div class="form-group">
                      <div class="position-relative w-100">
                        <div class="position-relative">
                          <i-feather name="lock" class="left-icon position-absolute"
                            [ngClass]="{'text-danger': (submitted || f.repeatPassword.touched) && f.repeatPassword.hasError('NoPassswordMatch')}">
                          </i-feather>
                          <input [type]="repeatPasswordVisible ? 'text' : 'password'" formControlName="repeatPassword"
                            class="form-control bg-white px-5 " placeholder="Repeat password"
                            [ngClass]="{'is-invalid': (submitted || f.repeatPassword.touched) && f.repeatPassword.hasError('NoPassswordMatch')}">
                          <i-feather [name]="repeatPasswordVisible ? 'eye' : 'eye-off'"
                            class="right-icon position-absolute" (click)="toggleRepeatPassword()"
                            [ngClass]="{'text-danger': (submitted || f.repeatPassword.touched) && f.repeatPassword.hasError('NoPassswordMatch')}">
                          </i-feather>
                        </div>
                        <small *ngIf="f.repeatPassword.dirty && f.repeatPassword.hasError('NoPassswordMatch')"
                          class="form-text text-danger">
                          The password does not match
                        </small>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="mt-3 text-center">
                  <button type="submit" class="btn btn-primary">
                    <span *ngIf="posting" class="spinner-border spinner-border-sm mr-1" role="status"
                      aria-hidden="true"></span>
                    Change Password
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
